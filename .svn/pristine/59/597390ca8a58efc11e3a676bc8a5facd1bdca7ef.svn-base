<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ConsumerMapper">
    <select id="findgraduatelistPage" parameterType="page" resultType="pd">
        SELECT a.*,(CASE WHEN result='0' THEN '未回访' WHEN result IS NULL THEN '未回访' WHEN result='1' THEN '已回访' ELSE '未回访' END ) AS resultname  FROM (
        SELECT a.id,DATE_FORMAT(a.czdate,'%Y-%m-%d %H:%i:%s') czdate,a.jg AS
        address,a.`name`,a.sex,a.age,a.tel,a.lxtel,a.isJob AS jobtype,a.cardid,a.remark,a.cate,a.uid,
        DATE_FORMAT(a.createdate,'%Y-%m-%d %H:%i:%s') createdate,
        a.isinsuran,
        a.location,
        a.bylxtel,
        a.bylxr,
        a.qzqd,
        a.xl,
        b.extel,
        b.jobadd,
        b.jobunit AS jobunit,
        b.arrtime AS arrtime,
        b.school,
        b.gradate,
        a.zy AS major,
        (CASE WHEN isjob='0' THEN '失业'
        WHEN isjob='1' THEN '就业'
        WHEN isjob='2' THEN '无意向就业'
        WHEN isjob='3' THEN '灵活就业'
        WHEN isjob='4' THEN '自主创业'
        ELSE '' END
        ) AS isjobname,
        IFNULL((SELECT (CASE WHEN re.result=0 THEN '0' WHEN re.result IS NULL THEN '0' WHEN re.result=1 THEN '1' ELSE '0' END )
        FROM tesp_revrecord re WHERE re.uid IS NOT NULL  AND a.uid=re.uid ORDER BY re.cztime DESC LIMIT 0,1),0) result,
        (SELECT dic.name FROM sys_dictionaries dic WHERE dic.DICTIONARIES_ID = a.xl) AS edubg
        FROM
        tesp_person a LEFT JOIN tesp_graduatedetai b ON a.uid=b.uid
        WHERE 1=1 AND cate='7c2896ad53df4440b81c251231b196fd' AND cate IS NOT NULL
        ) a
        WHERE 1=1
        <if test="pd.result!=null and pd.result!=''">
            and result=#{pd.result}
        </if>
        <if test="pd.id!=null and pd.id!=''">
            and a.id=#{pd.id}
        </if>
        <if test="pd.uid!=null and pd.uid!=''">
            and a.uid=#{pd.uid}
        </if>
        <if test="pd.jobtype!=null and pd.jobtype!=''">
            and a.jobtype=#{pd.jobtype}
        </if>
        <if test="pd.starttime!=null and pd.starttime!='' and pd.endtime!=null and pd.endtime!=''">
            and a.createdate BETWEEN #{pd.starttime} and #{pd.endtime}
        </if>
        <if test="pd.arrtime!=null and pd.arrtime!=''">
            and a.arrtime LIKE CONCAT(CONCAT(#{pd.arrtime}),'%')
        </if>
        <if test="pd.keywords != null and pd.keywords != ''">
            AND (
            name LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            sex LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            cardid LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            school LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            gradate LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            tel LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            xl LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            address LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            extel LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            jobadd LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            jobtype LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            jobunit LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            remark LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            arrtime LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            major LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            (CASE WHEN result='0' THEN '未回访' WHEN result IS NULL THEN '未回访' WHEN result='1' THEN '已回访' ELSE '未回访' END ) LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            edubg LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%')
            )
        </if>
        order by a.czdate desc
    </select>

    <select id="findgraduate" parameterType="pd" resultType="pd">
        SELECT a.*,(CASE WHEN result='0' THEN '未回访' WHEN result IS NULL THEN '未回访' WHEN result='1' THEN '已回访' ELSE '未回访' END ) AS resultname  FROM (
        SELECT a.id,DATE_FORMAT(a.czdate,'%Y-%m-%d %H:%i:%s') czdate,a.jg AS
        address,a.`name`,a.sex,a.age,a.tel,a.lxtel,a.isJob AS jobtype,a.cardid,a.remark,a.cate,a.uid,
        DATE_FORMAT(a.createdate,'%Y-%m-%d %H:%i:%s') createdate,
        a.isinsuran,
        a.location,
        a.bylxtel,
        a.bylxr,
        a.qzqd,
        a.xl,
        b.extel,
        b.jobadd,
        b.jobunit AS jobunit,
        b.arrtime AS arrtime,
        b.school,
        b.gradate,
        a.zy AS major,
        (CASE WHEN isjob='0' THEN '失业'
        WHEN isjob='1' THEN '就业'
        WHEN isjob='2' THEN '无意向就业'
        WHEN isjob='3' THEN '灵活就业'
        WHEN isjob='4' THEN '自主创业'
        ELSE '' END
        ) AS isjobname,
        IFNULL((SELECT (CASE WHEN re.result=0 THEN '0' WHEN re.result IS NULL THEN '0' WHEN re.result=1 THEN '1' ELSE '0' END )
        FROM tesp_revrecord re WHERE re.uid IS NOT NULL  AND a.uid=re.uid ORDER BY re.cztime DESC LIMIT 0,1),0) result,


        <if test="tables!= null and tables!= ''">
            a.ycstr,
            a.ycstrs,
            a.pcbh,
        </if>
        (SELECT dic.name FROM sys_dictionaries dic WHERE dic.DICTIONARIES_ID = a.xl) AS edubg
        FROM
        <if test="tables!= null and tables!= ''">
            ${tables} a
        </if>
        <if test="tables== null or tables== ''">
            tesp_person a
        </if>
        LEFT JOIN
        <if test="tables2!= null and tables2!= ''">
            ${tables2} b
        </if>
        <if test="tables2== null or tables2== ''">
            tesp_graduatedetai b
        </if>
        ON a.uid=b.uid
        WHERE a.cate='7c2896ad53df4440b81c251231b196fd'  AND cate IS NOT NULL
        ) a
        WHERE 1=1
        <if test="result!=null and result!=''">
            and result=#{result}
        </if>
        <if test="pcbh!= null and pcbh!= ''">
            and a.pcbh =#{pcbh}
        </if>
        <if test="id!=null and id!=''">
            and a.id=#{id}
        </if>
        <if test="uid!=null and uid!=''">
            and a.uid=#{uid}
        </if>
        <if test="jobtype!=null and jobtype!=''">
            and a.jobtype=#{jobtype}
        </if>
        <if test="starttime!=null and starttime!='' and endtime!=null and endtime!=''">
            and a.createdate BETWEEN #{starttime} and #{endtime}
        </if>
        <if test="arrtime!=null and arrtime!=''">
            and a.arrtime LIKE CONCAT(CONCAT(#{arrtime}),'%')
        </if>
        <if test="keywords != null and keywords != ''">
            AND (
            name LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            sex LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            cardid LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            school LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            gradate LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            tel LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            xl LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            address LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            extel LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            jobadd LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            jobtype LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            jobunit LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            remark LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            arrtime LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            major LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            (CASE WHEN result='0' THEN '未回访' WHEN result IS NULL THEN '未回访' WHEN result='1' THEN '已回访' ELSE '未回访' END ) LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            edubg LIKE CONCAT(CONCAT('%', #{keywords}),'%')
            )
        </if>
        order by a.czdate desc
    </select>


    <insert id="insertgraduate" parameterType="pd">
		INSERT INTO tesp_graduate(
		uid,
		school,
		edubg,
		jobadd,
		jobunit,
		remark,
		arrtime,
		major,
		gradate,
		extel
		)VALUES (
		#{uid},
		#{school},
		#{edubg},
		#{jobadd},
		#{jobunit},
		#{remark},
		#{arrtime},
		#{major},
		#{gradate},
		#{extel}
		)
	</insert>
    <update id="updategraduate" parameterType="pd">
		UPDATE tesp_graduatedetai
		set
		uid=#{uid},
		school=#{school},
		edubg=#{edubg},
		jobadd=#{jobadd},
		jobunit=#{jobunit},
		remark=#{remark},
		arrtime=#{arrtime},
		major=#{major},
		gradate=#{gradate},
		extel=#{extel}
		WHERE uid=#{uid}
	</update>
    <update id="updatejobunit" parameterType="pd">
		UPDATE tesp_jobreturn
		set
		jobunit=#{jobunit},
		`case`=#{case}
		WHERE uid=#{uid}
	</update>
    <delete id="deletegraduate" parameterType="pd">
		DELETE FROM tesp_graduatedetai WHERE id=#{id}
	</delete>

    <select id="findpovertylistPage" resultType="pd" parameterType="page">
        SELECT z.*,(CASE WHEN result='0' THEN '未回访' WHEN result IS NULL THEN '未回访' WHEN result='1' THEN '已回访' ELSE '未回访' END ) AS resultname FROM (SELECT a.id,DATE_FORMAT(a.createdate,'%Y-%m-%d %H:%i:%s') czdate,a.jg AS
        jgName,a.`name`,a.sex,a.age,a.tel,a.isJob,a.cardid,a.remark,a.cate,a.uid,
        a.isinsuran,
        a.location,
        a.bylxtel,
        a.bylxr,
        a.qzqd,
        IFNULL((SELECT dic.DICTIONARIES_ID FROM sys_dictionaries dic WHERE dic.NAME=a.jg),a.jg) jg,
        (CASE WHEN isjob='0' THEN '失业'
        WHEN isjob='1' THEN '就业'
        WHEN isjob='2' THEN '无意向就业'
        WHEN isjob='3' THEN '灵活就业'
        WHEN isjob='4' THEN '自主创业'
        ELSE '' END
        ) AS isjobname,
        IFNULL((SELECT (CASE WHEN re.result=0 THEN '0' WHEN re.result IS NULL THEN '0' WHEN re.result=1 THEN '1' ELSE '0' END )
        FROM tesp_revrecord re WHERE re.uid IS NOT NULL  AND a.uid=re.uid ORDER BY re.cztime DESC LIMIT 0,1),0) result
        FROM
        tesp_person a
        WHERE 1=1 AND cate='a6d55a9451534e14aefd082634f78ad9'
        ) z
        WHERE 1=1
        <if test="pd.keywords != null and pd.keywords != ''">
            AND (
            jgName LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            `name` LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            sex LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            age LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            tel LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            isJob LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            cardid LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            remark LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            isjobname LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            (CASE WHEN result='0' THEN '未回访' WHEN result IS NULL THEN '未回访' WHEN result='1' THEN '已回访' ELSE '未回访' END ) LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%')
            )
        </if>
        <if test="pd.result != null and pd.result != ''">
            and result = #{pd.result}
        </if>
        <if test="pd.startTime != null and pd.startTime != ''">
            and czdate &gt;= #{pd.startTime}
        </if>
        <if test="pd.endTime != null and pd.endTime != ''">
            and czdate &lt;= #{pd.endTime}
        </if>
        <if test="pd.jg != null and pd.jg != ''">
            and jg = #{pd.jg}
        </if>
        <if test="pd.tel != null and pd.tel != ''">
            and tel like concat('%',#{pd.tel},'%')
        </if>
        <if test="pd.isJob != null and pd.isJob != ''">
            and isjob = #{pd.isJob}
        </if>
        <if test="pd.cardId != null and pd.cardId != ''">
            and cardid like concat('%',#{pd.cardId},'%')
        </if>
        <if test="pd.id != null and pd.id != ''">
            and id = #{pd.id}
        </if>
        order by czdate desc
    </select>

    <select id="findpoverty" resultType="pd" parameterType="pd">
        select z.*,(CASE WHEN result='0' THEN '未回访' WHEN result IS NULL THEN '未回访' WHEN result='1' THEN '已回访' ELSE '未回访' END ) AS resultname from (SELECT a.id,DATE_FORMAT(a.createdate,'%Y-%m-%d %H:%i:%s') czdate,a.jg AS
        jgName,a.`name`,a.sex,a.age,a.tel,a.isJob,a.cardid,a.remark,a.cate,a.uid,a.lxtel,
        a.isinsuran,
        a.location,
        a.bylxtel,
        a.bylxr,
        a.qzqd,
        <if test="tables!= null and tables!= ''">
            a.ycstr,
            a.ycstrs,
            a.pcbh,
        </if>

        IFNULL((SELECT (CASE WHEN re.result=0 THEN '0' WHEN re.result IS NULL THEN '0' WHEN re.result=1 THEN '1' ELSE '0' END )
        FROM tesp_revrecord re WHERE re.uid IS NOT NULL  AND a.uid=re.uid ORDER BY re.cztime DESC LIMIT 0,1),0) result
        FROM
        <if test="tables!= null and tables!= ''">
            ${tables} a
        </if>
        <if test="tables== null or tables== ''">
            tesp_person a
        </if>
        WHERE 1=1 AND cate='a6d55a9451534e14aefd082634f78ad9'
       ) z
        WHERE 1=1
        <if test="pcbh!= null and pcbh!= ''">
            and pcbh =#{pcbh}
        </if>
        <if test="result != null and result != ''">
            and result = #{result}
        </if>
        <if test="id!=null and id!=''">
            and id=#{id}
        </if>
        <if test="uid!=null and uid!=''">
            and uid=#{uid}
        </if>
        <if test="starttime!=null and starttime!='' and endtime!=null and endtime!=''">
            and czdate BETWEEN #{starttime} and #{endtime}
        </if>
        <if test="keywords != null and keywords != ''">
            AND (
            jgName LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            `name` LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            sex LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            age LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            tel LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            isJob LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            cardid LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            remark LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            isjobname LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            (CASE WHEN result='0' THEN '未回访' WHEN result IS NULL THEN '未回访' WHEN result='1' THEN '已回访' ELSE '未回访' END ) LIKE CONCAT(CONCAT('%', #{keywords}),'%')
            )
        </if>
        order by czdate desc
    </select>


    <insert id="insertpoverty" parameterType="pd">
	INSERT INTO tesp_poverty(
		cztime,
		name,
		tel,
		remark
	)VALUES (
		#{cztime},
		#{name},
		#{tel},
		#{remark}
	)
	</insert>

    <update id="updatepoverty" parameterType="pd">
		UPDATE tesp_poverty
		set
		cztime=#{cztime},
		name=#{name},
		tel=#{tel},
		remark=#{remark}
		WHERE id=#{id}
	</update>

    <delete id="deletepoverty" parameterType="pd">
		DELETE FROM tesp_poverty WHERE id=#{id}
	</delete>


    <select id="findsbbtrylistPage" resultType="pd" parameterType="page">
        select a.*,(CASE WHEN result='0' THEN '未回访' WHEN result IS NULL THEN '未回访' WHEN result='1' THEN '已回访' ELSE '未回访' END ) AS resultname from (
        select a.id,a.name,a.tel,a.remark,a.cate,DATE_FORMAT(a.createdate,'%Y-%m-%d %H:%i:%s') cztime,a.lxtel,
        a.uid,
        a.isinsuran,
        <if test="pd.tables!= null and pd.tables!= ''">
            a.ycstr,
            a.ycstrs,
            a.pcbh,
        </if>
        a.location,
        a.bylxtel,
        a.bylxr,
        a.qzqd,
        IFNULL((SELECT (CASE WHEN re.result=0 THEN '0' WHEN re.result IS NULL THEN '0' WHEN re.result=1 THEN '1' ELSE '0' END )
        FROM tesp_revrecord re WHERE re.uid IS NOT NULL  AND a.uid=re.uid ORDER BY re.cztime DESC LIMIT 0,1),0) result
        from
        <if test="pd.tables!= null and pd.tables!= ''">
            ${pd.tables} a
        </if>
        <if test="pd.tables== null or pd.tables== ''">
            tesp_person a
        </if>
        where cate='54acc890c8bc433ca53dc19b06d71857'
        ) a
        where 1=1
        <if test="pd.keywords != null and pd.keywords != ''">
            AND (
            `name` LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            tel LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            remark LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            (CASE WHEN result='0' THEN '未回访' WHEN result IS NULL THEN '未回访' WHEN result='1' THEN '已回访' ELSE '未回访' END ) LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%')
            )
        </if>
        <if test="pd.pcbh!= null and pd.pcbh!= ''">
            and a.pcbh =#{pd.pcbh}
        </if>
        <if test="pd.result!=null and pd.result!=''">
            and result=#{pd.result}
        </if>
        <if test="pd.id!=null and pd.id!=''">
            and id=#{pd.id}
        </if>
        <if test="pd.uid!=null and pd.uid!=''">
            and uid=#{pd.uid}
        </if>
        <if test="pd.starttime!=null and pd.starttime!='' and pd.endtime!=null and pd.endtime!=''">
            and cztime BETWEEN #{pd.starttime} and #{pd.endtime}
        </if>
        order by cztime desc
    </select>

    <select id="findsbbtry" resultType="pd" parameterType="pd">
        SELECT p.id,(SELECT a.czdate FROM (
        SELECT czdate,uid FROM tesp_qtfw
        UNION ALL
        SELECT cztime AS czdate,uid FROM tesp_jobreturn
        UNION ALL
        SELECT czdate,uid FROM tesp_tj
        UNION ALL
        SELECT cztime AS czdate,uid FROM tesp_trainreco
        UNION ALL
        SELECT czdate,uid FROM tesp_ywyd
        UNION ALL
        SELECT czdate,uid FROM tesp_zczx
        UNION ALL
        SELECT cztime AS czdate,uid FROM tesp_revrecord
        UNION ALL
        SELECT czdate,uid FROM tesp_jobreg
        ) a WHERE uid = p.uid
        ORDER BY a.czdate DESC LIMIT 1) AS newServiceTime,
        (SELECT COUNT(uid) FROM (
        SELECT uid FROM tesp_qtfw
        UNION ALL
        SELECT uid FROM tesp_jobreturn
        UNION ALL
        SELECT uid FROM tesp_tj
        UNION ALL
        SELECT uid FROM tesp_trainreco
        UNION ALL
        SELECT uid FROM tesp_ywyd
        UNION ALL
        SELECT uid FROM tesp_zczx
        UNION ALL
        SELECT uid FROM tesp_revrecord
        UNION ALL
        SELECT uid FROM tesp_jobreg
        ) a WHERE uid = p.uid) AS serviceCount,
        p.jg AS jgName,
        p.name,
        p.lxtel,
        p.cardid,
        p.age,
        p.sex,
        p.isjob,
        (SELECT re.case FROM tesp_jobreturn re WHERE re.uid = p.uid ORDER BY re.cztime DESC LIMIT 1) AS cate,
        (SELECT GROUP_CONCAT((SELECT gwflname FROM tesp_jobtype jt WHERE jt.code = reg.jobname)) AS gwflname FROM
        tesp_jobreg reg WHERE reg.uid = p.uid) AS qzgw,
        (SELECT GROUP_CONCAT(c.name)
        FROM (SELECT a.name,a.lxr,a.addr,a.tel,b.id,b.jobname,
        CONCAT(b.agestart,'-',b.ageend) age,
        b.jobtype,
        b.xl,
        b.zyyq,
        b.remark,
        b.czman,
        b.uid,
        DATE_FORMAT(b.czdate,'%Y-%m-%d %H:%i:%s') czdate,
        b.zgrs,
        b.sex,
        b.agestart,
        b.ageend,
        b.gzdy,
        b.gwyq FROM tesp_employreg b LEFT JOIN tesp_company a ON a.uid=b.uid) c
        LEFT JOIN tesp_tj d ON c.id=d.regid
        WHERE d.uid= p.uid
        AND d.istj='1' ORDER BY c.czdate DESC LIMIT 1) AS companyName,
        (SELECT count(c.name)
        FROM (SELECT a.name,
        DATE_FORMAT(b.czdate,'%Y-%m-%d %H:%i:%s') czdate,
        b.id,
        b.uid FROM tesp_employreg b LEFT JOIN tesp_company a ON a.uid=b.uid) c
        LEFT JOIN tesp_tj d ON c.id=d.regid
        WHERE d.uid= p.uid
        AND d.istj='1' ORDER BY c.czdate DESC LIMIT 1) AS companyNum,
        (SELECT (SELECT `gwflname` FROM tesp_jobtype jt WHERE jt.code = jr.jobname) AS jobName FROM tesp_jobreturn jr
        WHERE jr.uid = p.uid ORDER BY jr.cztime DESC
        LIMIT 1) AS isjobwork,
        (SELECT jobunit FROM tesp_jobreturn jt2 WHERE jt2.uid = p.uid  order by jt2.id desc limit 1) AS jobunit,
        (SELECT GROUP_CONCAT(CONCAT((SELECT dic.name FROM `sys_dictionaries` dic WHERE dic.dictionaries_id =
        t.jobvar),',',t.trainname)) FROM tesp_trainreco t WHERE t.uid = p.uid LIMIT 1) AS trainreco,
        (SELECT IFNULL((SELECT rec.isjt FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1)
        ,
        IF((SELECT COUNT(*) FROM tesp_jobreturn jr WHERE jr.uid= p.uid ORDER BY cztime DESC LIMIT 1)=0,NULL,1)
        )) AS isjt,
        (SELECT rec.unconnet FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1) AS unconnet,
        ifnull((SELECT rec.result FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1),0) AS
        result,
        (select group_concat((select name from sys_dictionaries dic where zc.zczxname=dic.DICTIONARIES_ID)) zczxname
        from tesp_zczx zc where zc.uid=p.uid group by uid ) zczxname
        FROM tesp_person p WHERE 1=1 AND p.cate='54acc890c8bc433ca53dc19b06d71857'

        <if test="starttime != null and starttime != ''">
            and p.createdate &gt;= #{starttime}
        </if>
        <if test="endtime != null and endtime != ''">
            and p.createdate &lt;= #{endtime}
        </if>
        <if test="result != null and result != ''">
            and ifnull((SELECT rec.result FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1),0)
            = #{result}
        </if>
        <if test="keywords != null and keywords != ''">
            AND (
            name LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            sex LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            tel LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            DATE_FORMAT(p.createdate,'%Y-%m-%d %H:%i:%s') LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            remark LIKE CONCAT(CONCAT('%', #{keywords}),'%')
            )
        </if>
        order by czdate desc

    </select>


    <insert id="insertsbbtry" parameterType="pd">
	INSERT INTO tesp_sbbtry(
		cztime,
		name,
		tel,
		remark
	)VALUES (
		#{cztime},
		#{name},
		#{tel},
		#{remark}
	)
	</insert>

    <update id="updatesbbtry" parameterType="pd">
		UPDATE tesp_sbbtry
		set
		cztime=#{cztime},
		name=#{name},
		tel=#{tel},
		remark=#{remark}
		WHERE id=#{id}
	</update>

    <delete id="deletesbbtry" parameterType="pd">
		DELETE FROM tesp_sbbtry WHERE id=#{id}
	</delete>

    <select id="findjzbtrylistPage" parameterType="page" resultType="pd">
        select a.*,(CASE WHEN result='0' THEN '未回访' WHEN result IS NULL THEN '未回访' WHEN result='1' THEN '已回访' ELSE '未回访' END ) AS resultname from (
        select
        a.id,
        a.name,
        a.cardid,
        a.lxtel as tel,
        a.jg as address,
        b.remark,
        a.cate,
        DATE_FORMAT(a.createdate,'%Y-%m-%d %H:%i:%s') as cztime,
        b.creden as credenname,
        b.jobvar as jobname,
        b.level,
        a.isinsuran,
        a.location,
        a.bylxtel,
        a.bylxr,
        a.qzqd,
        a.uid,
        <if test="pd.tables!= null and pd.tables!= ''">
            a.ycstr,
            a.ycstrs,
            a.pcbh,
        </if>
        IFNULL((SELECT (CASE WHEN re.result=0 THEN '0' WHEN re.result IS NULL THEN '0' WHEN re.result=1 THEN '1' ELSE '0' END )
        FROM tesp_revrecord re WHERE re.uid IS NOT NULL  AND a.uid=re.uid ORDER BY re.cztime DESC LIMIT 0,1),0) result,
        c.name as levelname,
        d.name as creden,
        e.name as jobvar
        from
        <if test="pd.tables!= null and pd.tables!= ''">
            ${pd.tables} a
        </if>
        <if test="pd.tables== null or pd.tables== ''">
            tesp_person a
        </if>
        left join (SELECT *
        FROM
        <if test="pd.tables2!= null and pd.tables2!= ''">
            ${pd.tables2}
        </if>
        <if test="pd.tables2== null or pd.tables2== ''">
            tesp_trainreco
        </if>
        WHERE id in
        (SELECT MAX(id)
        FROM
        <if test="pd.tables2!= null and pd.tables2!= ''">
            ${pd.tables2}
        </if>
        <if test="pd.tables2== null or pd.tables2== ''">
            tesp_trainreco
        </if>
        GROUP BY uid)) b on a.uid=b.uid
        LEFT JOIN sys_dictionaries c ON b.level=c.DICTIONARIES_ID
        LEFT JOIN sys_dictionaries d ON b.creden=d.DICTIONARIES_ID
        left join sys_dictionaries e on b.jobvar=e.DICTIONARIES_ID
        where a.cate='7b95e900ca3a4eee943cb3ca11e51fd1'
        ) a
        where 1=1
        <if test="pd.keywords != null and pd.keywords != ''">
            AND (
            `name` LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            cardid LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            tel LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            address LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            remark LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            creden LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            level LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            levelname LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            credenname LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            jobvar LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            (CASE WHEN result='0' THEN '未回访' WHEN result IS NULL THEN '未回访' WHEN result='1' THEN '已回访' ELSE '未回访' END ) LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%')
            )
        </if>
        <if test="pd.pcbh!= null and pd.pcbh!= ''">
            and a.pcbh =#{pd.pcbh}
        </if>
        <if test="pd.result!=null and pd.result!=''">
            and a.result=#{pd.result}
        </if>
        <if test="pd.uid!=null and pd.uid!=''">
            and a.uid=#{pd.uid}
        </if>
        <if test="pd.level!=null and pd.level!=''">
            and a.level=#{pd.level}
        </if>
        <if test="pd.creden!=null and pd.creden!=''">
            and a.credenname=#{pd.creden}
        </if>
        <if test="pd.starttime!=null and pd.starttime!='' and pd.endtime!=null and pd.endtime!=''">
            and a.cztime BETWEEN #{pd.starttime} and #{pd.endtime}
        </if>
        order by cztime desc
    </select>

    <select id="findjzbtry" parameterType="pd" resultType="pd">
        SELECT p.id,(SELECT a.czdate FROM (
        SELECT czdate,uid FROM tesp_qtfw
        UNION ALL
        SELECT cztime AS czdate,uid FROM tesp_jobreturn
        UNION ALL
        SELECT czdate,uid FROM tesp_tj
        UNION ALL
        SELECT cztime AS czdate,uid FROM tesp_trainreco
        UNION ALL
        SELECT czdate,uid FROM tesp_ywyd
        UNION ALL
        SELECT czdate,uid FROM tesp_zczx
        UNION ALL
        SELECT cztime AS czdate,uid FROM tesp_revrecord
        UNION ALL
        SELECT czdate,uid FROM tesp_jobreg
        ) a WHERE uid = p.uid
        ORDER BY a.czdate DESC LIMIT 1) AS newServiceTime,
        (SELECT COUNT(uid) FROM (
        SELECT uid FROM tesp_qtfw
        UNION ALL
        SELECT uid FROM tesp_jobreturn
        UNION ALL
        SELECT uid FROM tesp_tj
        UNION ALL
        SELECT uid FROM tesp_trainreco
        UNION ALL
        SELECT uid FROM tesp_ywyd
        UNION ALL
        SELECT uid FROM tesp_zczx
        UNION ALL
        SELECT uid FROM tesp_revrecord
        UNION ALL
        SELECT uid FROM tesp_jobreg
        ) a WHERE uid = p.uid) AS serviceCount,
        p.jg AS jgName,
        p.name,
        p.lxtel,
        p.cardid,
        p.age,
        p.sex,
        p.isjob,
        (SELECT (SELECT dic.name FROM sys_dictionaries dic WHERE tra.creden=dic.DICTIONARIES_ID) FROM tesp_trainreco tra
        WHERE tra.uid = p.uid ORDER BY tra.id DESC LIMIT 1 ) credenname,
        (SELECT (SELECT dic.name FROM sys_dictionaries dic WHERE tra.jobvar=dic.DICTIONARIES_ID) FROM tesp_trainreco tra
        WHERE tra.uid = p.uid ORDER BY tra.id DESC LIMIT 1 ) jobvarname,
        (SELECT re.case FROM tesp_jobreturn re WHERE re.uid = p.uid ORDER BY re.cztime DESC LIMIT 1) AS cate,
        (SELECT GROUP_CONCAT((SELECT gwflname FROM tesp_jobtype jt WHERE jt.code = reg.jobname)) AS gwflname FROM
        tesp_jobreg reg WHERE reg.uid = p.uid) AS qzgw,
        (SELECT GROUP_CONCAT(c.name)
        FROM (SELECT a.name,a.lxr,a.addr,a.tel,b.id,b.jobname,
        CONCAT(b.agestart,'-',b.ageend) age,
        b.jobtype,
        b.xl,
        b.zyyq,
        b.remark,
        b.czman,
        b.uid,
        DATE_FORMAT(b.czdate,'%Y-%m-%d %H:%i:%s') czdate,
        b.zgrs,
        b.sex,
        b.agestart,
        b.ageend,
        b.gzdy,
        b.gwyq FROM tesp_employreg b LEFT JOIN tesp_company a ON a.uid=b.uid) c
        LEFT JOIN tesp_tj d ON c.id=d.regid
        WHERE d.uid= p.uid
        AND d.istj='1' ORDER BY c.czdate DESC LIMIT 1) AS companyName,
        (SELECT count(c.name)
        FROM (SELECT a.name,
        b.id,
        DATE_FORMAT(b.czdate,'%Y-%m-%d %H:%i:%s') czdate,
        b.uid FROM tesp_employreg b LEFT JOIN tesp_company a ON a.uid=b.uid) c
        LEFT JOIN tesp_tj d ON c.id=d.regid
        WHERE d.uid= p.uid
        AND d.istj='1' ORDER BY c.czdate DESC LIMIT 1) AS companyNum,
        (SELECT (SELECT `gwflname` FROM tesp_jobtype jt WHERE jt.code = jr.jobname) AS jobName FROM tesp_jobreturn jr
        WHERE jr.uid = p.uid ORDER BY jr.cztime DESC
        LIMIT 1) AS isjobwork,
        (SELECT jobunit FROM tesp_jobreturn jt2 WHERE jt2.uid = p.uid  order by jt2.id desc limit 1) AS jobunit,
        (SELECT GROUP_CONCAT(CONCAT((SELECT dic.name FROM `sys_dictionaries` dic WHERE dic.dictionaries_id =
        t.jobvar),',',t.trainname)) FROM tesp_trainreco t WHERE t.uid = p.uid LIMIT 1) AS trainreco,
        (SELECT IFNULL((SELECT rec.isjt FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1)
        ,
        IF((SELECT COUNT(*) FROM tesp_jobreturn jr WHERE jr.uid= p.uid ORDER BY cztime DESC LIMIT 1)=0,NULL,1)
        )) AS isjt,
        (SELECT rec.unconnet FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1) AS unconnet,
        IFNULL((SELECT rec.result FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1),0) AS
        result
        FROM tesp_person p WHERE 1=1 AND p.cate='7b95e900ca3a4eee943cb3ca11e51fd1'
        <if test="starttime != null and starttime != ''">
            and createdate &gt;= #{starttime}
        </if>
        <if test="endtime != null and endtime != ''">
            and createdate &lt;= #{endtime}
        </if>
        <if test="result != null and result != ''">
            and ifnull((SELECT rec.result FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1),0)
            = #{result}
        </if>
        <if test="keywords != null and keywords != ''">
            AND (
            cardid LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            name LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            jg LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            sex LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            tel LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            isjob LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            (SELECT (SELECT dic.name FROM sys_dictionaries dic WHERE tra.creden=dic.DICTIONARIES_ID) FROM tesp_trainreco tra
            WHERE tra.uid = p.uid ORDER BY tra.id DESC LIMIT 1 ) LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            (SELECT (SELECT dic.name FROM sys_dictionaries dic WHERE tra.jobvar=dic.DICTIONARIES_ID) FROM tesp_trainreco tra
            WHERE tra.uid = p.uid ORDER BY tra.id DESC LIMIT 1 ) LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            remark LIKE CONCAT(CONCAT('%', #{keywords}),'%')
            )
        </if>
        <if test="creden!=null and creden!=''">
            and (SELECT tra.creden FROM tesp_trainreco tra
            WHERE tra.uid = p.uid ORDER BY tra.id DESC LIMIT 1 )=#{creden}
        </if>
        order by czdate desc
    </select>


	<insert id="insertjzbtry" parameterType="pd">
	INSERT INTO tesp_jzbtry(
	cztime,
	name,
	cardid,
	jobvar,
	level,
	creden,
	tel,
	address,
	remark
	)VALUES (
	#{cztime},
	#{name},
	#{cardid},
	#{jobvar},
	#{level},
	#{creden},
	#{tel},
	#{address},
	#{remark}
	)
	</insert>

    <update id="updatejzbtry" parameterType="pd">
		UPDATE tesp_jzbtry
		set
		cztime=#{cztime},
		name=#{name},
		cardid=#{cardid},
		jobvar=#{jobvar},
		level=#{level},
		creden=#{creden},
		tel=#{tel},
		address=#{address},
		remark=#{remark}
		WHERE id=#{id}
	</update>

    <delete id="deletejzbtry" parameterType="pd">
		DELETE FROM tesp_jzbtry WHERE id=#{id}
	</delete>

    <!--	 企业信息-->
    <select id="findcompanylistPage" resultType="pd" parameterType="page">
        select a.*,(CASE WHEN result='0' THEN '未回访' WHEN result IS NULL THEN '未回访' WHEN result='1' THEN '已回访' ELSE '未回访' END ) AS resultname from (
        SELECT
        a.id,
        a.uid,
        a.qytype,
        a.name,
        a.addr,
        a.email,
        a.lxr,
        a.tel,
        a.lxtel,
        a.bylxr,
        a.bylxtel,
        a.czman,
        a.isinsuran,
        a.intro,
        a.qzqd,
        IFNULL((SELECT (CASE WHEN re.result=0 THEN '0' WHEN re.result IS NULL THEN '0' WHEN re.result=1 THEN '1' ELSE '0' END )
        FROM tesp_revrecord re WHERE re.uid IS NOT NULL  AND a.uid=re.uid ORDER BY re.cztime DESC LIMIT 0,1),0) result,
        DATE_FORMAT(a.czdate,'%Y-%m-%d %H:%i:%s') czdate,
        b.name AS qytypename
        FROM tesp_company a
        LEFT JOIN sys_dictionaries b ON a.qytype=b.DICTIONARIES_ID
        ) a

        where 1=1
        <if test="pd.result!=null and pd.result!=''">
            and a.result=#{pd.result}
        </if>
        <if test="pd.id!=null and pd.id!=''">
            and a.id=#{pd.id}
        </if>
        <if test="pd.name!=null and pd.name!=''">
            and a.name LIKE CONCAT(CONCAT('%', #{pd.name}),'%')
        </if>

        <if test="pd.qytype!=null and pd.qytype!=''">
            and a.qytype=#{pd.qytype}
        </if>
        <if test="pd.lxr!=null and pd.lxr!=''">
            and a.lxr=#{pd.lxr}
        </if>
        <if test="pd.lxtel!=null and pd.lxtel!=''">
            and a.lxtel=#{pd.lxtel}
        </if>
        <if test="pd.uid!=null and pd.uid!=''">
            and a.uid=#{pd.uid}
        </if>
        <if test="pd.keywords != null and pd.keywords != ''">
            AND (
            a.qytype LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            a.name LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            a.addr LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            a.email LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            a.lxr LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            a.tel LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            a.lxtel LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            a.bylxr LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            (CASE WHEN result='0' THEN '未回访' WHEN result IS NULL THEN '未回访' WHEN result='1' THEN '已回访' ELSE '未回访' END ) LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            a.bylxtel LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%')
            )
        </if>
        order by czdate desc
    </select>

    <select id="findcomreglistPage" resultType="pd" parameterType="page">
        SELECT DISTINCT a.*,
        b.name AS qytypename FROM (SELECT
        a.id,
        a.uid,
        a.qytype,
        a.name,
        a.addr,
        a.email,
        a.lxr,
        a.tel,
        a.lxtel,
        a.bylxr,
        a.bylxtel,
        a.czman,
        a.isinsuran,
        a.intro,
        a.cate,
        a.qzqd,
        DATE_FORMAT(a.createdate,'%Y-%m-%d %H:%i:%s') czdate
        FROM tesp_company a,(SELECT DISTINCT uid FROM tesp_employreg WHERE isvalid = 1
        <if test="pd.starttime!=null and pd.starttime!='' and pd.endtime!=null and pd.endtime!=''">
            and createdate BETWEEN #{pd.starttime} and #{pd.endtime}
        </if>
        ) b  WHERE a.uid=b.uid
        <if test="pd.id!=null and pd.id!=''">
            and a.id=#{pd.id}
        </if>
        <if test="pd.name!=null and pd.name!=''">
            and a.name LIKE CONCAT(CONCAT('%', #{pd.name}),'%')
        </if>
        <if test="pd.qytype!=null and pd.qytype!=''">
            and a.qytype=#{pd.qytype}
        </if>
        <if test="pd.lxr!=null and pd.lxr!=''">
            and a.lxr=#{pd.lxr}
        </if>
        <if test="pd.lxtel!=null and pd.lxtel!=''">
            and a.lxtel=#{pd.lxtel}
        </if>
        <if test="pd.uid!=null and pd.uid!=''">
            and a.uid=#{pd.uid}
        </if>
        <if test="pd.uid!=null and pd.uid!=''">
            and a.uid=#{pd.uid}
        </if>
        <if test="pd.qzqd!=null and pd.qzqd!=''">
            and a.qzqd=#{pd.qzqd}
        </if>

        <if test="pd.keywords != null and pd.keywords != ''">
            AND (
            a.qytype LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            a.name LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            a.addr LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            a.email LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            a.lxr LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            a.tel LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            a.lxtel LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            a.bylxr LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            a.bylxtel LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%')
            )
        </if>
        ) a
        LEFT JOIN sys_dictionaries b ON a.qytype=b.DICTIONARIES_ID
        order by a.id desc
    </select>

    <select id="findcompany" resultType="pd" parameterType="pd">
        select * from (
        SELECT
        a.id,
        a.uid,
        a.qytype,
        a.name,
        a.addr,
        a.email,
        a.lxr,
        a.tel,
        a.lxtel,
        a.bylxr,
        a.bylxtel,
        a.czman,
        DATE_FORMAT(a.czdate,'%Y-%m-%d %H:%i:%s') czdate,
        a.isimpot,
        a.cate,
        a.isinsuran,
        a.intro,
        a.qzqd,
        IFNULL((SELECT (CASE WHEN re.result=0 THEN '0' WHEN re.result IS NULL THEN '0' WHEN re.result=1 THEN '1' ELSE '0' END )
        FROM tesp_revrecord re WHERE re.uid IS NOT NULL  AND a.uid=re.uid ORDER BY re.cztime DESC LIMIT 0,1),0) result,
        b.name AS qytypename
        FROM tesp_company a
        LEFT JOIN sys_dictionaries b ON a.qytype=b.DICTIONARIES_ID

        ) z
        where 1=1
        <if test="uid!=null and uid!=''">
            and uid=#{uid}
        </if>
        <if test="qytype!=null and qytype!=''">
            and qytype=#{qytype}
        </if>
        <if test="lxr!=null and lxr!=''">
            and lxr=#{lxr}
        </if>
        <if test="lxtel!=null and lxtel!=''">
            and lxtel=#{lxtel}
        </if>
        <if test="result!=null and result!=''">
            and result=#{result}
        </if>
        <if test="tel!=null and tel!=''">
            and tel=#{tel}
        </if>
        <if test="name!=null and name!=''">
            and name LIKE CONCAT(CONCAT('%', #{name}),'%')
        </if>
        <if test="keywords != null and keywords != ''">
            AND (
            z.name LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            z.addr LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            z.email LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            z.lxr LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            z.tel LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            z.lxtel LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            z.bylxr LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            z.bylxtel LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            z.czman LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            z.isinsuran LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            z.intro LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            z.qzqd LIKE CONCAT(CONCAT('%', #{keywords}),'%')
            )
        </if>
    </select>


    <insert id="insertcompany" parameterType="pd">
	INSERT INTO tesp_company(
		uid,
		qytype,
		name,
		addr,
		email,
		lxr,
		tel,
		lxtel,
		bylxr,
		bylxtel,
		czman,
		czdate,
		isinsuran,
		intro,
		qzqd,
		isimpot
	)VALUES (
		#{uid},
		#{qytype},
		#{name},
		#{addr},
		#{email},
		#{lxr},
		#{tel},
		#{lxtel},
		#{bylxr},
		#{bylxtel},
		#{czman},
		#{czdate},
		#{isinsuran},
		#{intro},
		#{qzqd},
		#{isimpot}
	)
	</insert>

    <update id="updatecompany" parameterType="pd">
		UPDATE tesp_company
		set
		uid=#{uid},
		qytype=#{qytype},
		name=#{name},
		addr=#{addr},
		email=#{email},
		lxr=#{lxr},
		tel=#{tel},
		lxtel=#{lxtel},
		bylxr=#{bylxr},
		bylxtel=#{bylxtel},
		czman=#{czman},
		czdate=#{czdate},
		isinsuran=#{isinsuran},
		intro=#{intro},
		qzqd=#{qzqd},
		isimpot=#{isimpot}
		WHERE id=#{id}
	</update>

    <delete id="deletecompany" parameterType="pd">
		DELETE FROM tesp_company WHERE id=#{id}
	</delete>

    <select id="findemployreglistPage" resultType="pd" parameterType="page">
        SELECT
        a.id,
        a.jobname,
        a.jobtype,
        a.xl,
        a.zyyq,
        a.remark,
        a.czman,
        a.uid,
        DATE_FORMAT(a.czdate,'%Y-%m-%d %H:%i:%s') czdate,
        a.zgrs,
        a.sex,
        a.agestart,
        a.ageend,
        a.gzdy,
        a.gwyq,
        a.isvalid,
        a.gzaddr,
        a.specificjobname,
        a.experience,
        b.gwflname,CONCAT(a.agestart,'-',a.ageend) age,
        c.name AS jobtypename,
        d.name AS xlname,
        e.name AS sexname,
        f.name AS gzdyname
        FROM tesp_employreg a
        LEFT JOIN tesp_jobtype b ON a.jobname=b.code
        LEFT JOIN sys_dictionaries c ON a.jobtype=c.DICTIONARIES_ID
        LEFT JOIN sys_dictionaries d ON a.xl=d.DICTIONARIES_ID
        LEFT JOIN sys_dictionaries e ON a.sex=e.DICTIONARIES_ID
        LEFT JOIN sys_dictionaries f ON a.gzdy=f.DICTIONARIES_ID
        where 1=1 and a.isvalid='1'
        <if test="pd.uid!=null and pd.uid!=''">
            and uid=#{pd.uid}
        </if>
    </select>

    <select id="findemployreg" resultType="pd" parameterType="pd">
        SELECT
        a.id,
        a.jobname,
        a.jobtype,
        a.xl,
        a.zyyq,
        a.remark,
        a.czman,
        a.uid,
        DATE_FORMAT(a.createdate,'%Y-%m-%d %H:%i:%s') czdate,
        a.zgrs,
        a.sex,
        a.agestart,
        a.ageend,
        a.gzdy,
        a.gwyq,
        a.isvalid,
        a.gzaddr,
        a.specificjobname,
        a.experience,
        b.gwflname,CONCAT(a.agestart,'-',a.ageend) age,
        c.name AS jobtypename,
        d.name AS xlname,
        e.name AS sexname,
        f.name AS gzdyname
        FROM tesp_employreg a
        LEFT JOIN tesp_jobtype b ON a.jobname=b.code
        LEFT JOIN sys_dictionaries c ON a.jobtype=c.DICTIONARIES_ID
        LEFT JOIN sys_dictionaries d ON a.xl=d.DICTIONARIES_ID
        LEFT JOIN sys_dictionaries e ON a.sex=e.DICTIONARIES_ID
        LEFT JOIN sys_dictionaries f ON a.gzdy=f.DICTIONARIES_ID
        where 1=1 and a.isvalid='1'
        <if test="uid!=null and uid!=''">
            and uid=#{uid}
        </if>
        <if test="starttime!=null and starttime!='' and endtime!=null and endtime!=''">
            and a.createdate BETWEEN #{starttime} and #{endtime}
        </if>
    </select>

    <insert id="insertemployreg" parameterType="pd">
	INSERT INTO tesp_employreg(
		jobname,
		jobtype,
		xl,
		zyyq,
		remark,
		czman,
		uid,
		czdate,
		zgrs,
		sex,
		agestart,
		ageend,
		gzdy,
		gwyq,
		isimpot,
		gzaddr,
		specificjobname,
		experience
	)VALUES (
		#{jobname},
		#{jobtype},
		#{xl},
		#{zyyq},
		#{remark},
		#{czman},
		#{uid},
		#{czdate},
		#{zgrs},
		#{sex},
		#{agestart},
		#{ageend},
		#{gzdy},
		#{gwyq},
		#{isimpot},
		#{gzaddr},
		#{specificjobname},
		#{experience}
	)
	</insert>

    <update id="updateemployreg" parameterType="pd">
		UPDATE tesp_employreg
		set
		jobname=#{jobname},
		jobtype=#{jobtype},
		xl=#{xl},
		zyyq=#{zyyq},
		remark=#{remark},
		czman=#{czman},
		uid=#{uid},
		czdate=#{czdate},
		zgrs=#{zgrs},
		sex=#{sex},
		agestart=#{agestart},
		ageend=#{ageend},
		gzdy=#{gzdy},
		gwyq=#{gwyq},
		isvalid=#{isvalid},
		gzaddr=#{gzaddr},
		specificjobname=#{specificjobname},
		experience=#{experience},
		isimpot=#{isimpot}

		WHERE id=#{id}
	</update>

    <delete id="deleteemployreg" parameterType="pd">
		DELETE FROM tesp_employreg WHERE id=#{id}
	</delete>

    <select id="getcompanytoday" parameterType="pd" resultType="pd">
		SELECT a.zjhm,COUNT(a.id) num,b.name
		FROM tthjl a
		LEFT JOIN tesp_company b ON a.zjhm=b.tel
		WHERE 1=1 AND TO_DAYS(kssj) = TO_DAYS(NOW())
		GROUP BY a.zjhm
	</select>

    <select id="getpersontoday" parameterType="pd" resultType="pd">
		SELECT a.zjhm,COUNT(a.id) num,b.name
		FROM tthjl a
		LEFT JOIN tesp_person b ON a.zjhm=b.tel
		WHERE 1=1 AND TO_DAYS(kssj) = TO_DAYS(NOW())
		GROUP BY a.zjhm
	</select>

    <select id="getcalltoday" resultType="pd" parameterType="pd">
		select zjhm as tel,count(id) num,DATE_FORMAT(max(jssj),'%Y-%m-%d %H:%i:%s') jssj from tthjl where 1=1 AND TO_DAYS(kssj) = TO_DAYS(NOW()) and thfx=0 GROUP BY zjhm
	</select>

    <select id="getDIC" parameterType="pd" resultType="pd">
        select DICTIONARIES_ID,BIANMA from sys_dictionaries where name=#{name}
        <if test="bianma!=null and bianma!=''">
            and bianma LIKE CONCAT(CONCAT('%', #{bianma}),'%')
        </if>
        <if test="level!=null and level!=''">
            and bianma LIKE #{level}
        </if>
    </select>

    <select id="getDicAll" parameterType="pd" resultType="pd">
		select * from sys_dictionaries
	</select>

    <select id="getjobtype" parameterType="pd" resultType="pd">
		select * from tesp_jobtype where gwflname=#{gwflname}
	</select>

    <update id="editPerson" parameterType="pd">
	UPDATE tesp_person
		set
		uid=#{uid},
		sex=#{sex},
		name=#{name},
		addr=#{addr},
		email=#{email},
		age=#{age},
		jg=#{jg},
		addr=#{jg},
		tel=#{tel},
		lxtel=#{lxtel},
		czman=#{czman},
		czdate=now(),
		isjob=#{isjob},
		xl=#{xl},
		zy=#{zy},
		cardid=#{cardid},
		cate=#{cate},
		remark=#{remark},
		isinsuran=#{isinsuran},
		bylxtel=#{bylxtel},
		bylxr=#{bylxr},
		qzqd=#{qzqd},
		location=#{location}
		WHERE uid=#{uid}
	</update>

    <insert id="savePerson" parameterType="pd">
		insert into
		tesp_person
		(
		uid,
		sex,
		name,
		addr,
		email,
		tel,
		lxtel,
		age,
		jg,
		czman,
		czdate,
		isjob,
		xl,
		zy,
		cardid,
		cate,
		remark,
		isinsuran,
		bylxtel,
		bylxr,
		qzqd,
		isimpot,
		location
		) values (
		#{uid},
		#{sex},
		#{name},
		#{addr},
		#{email},
		#{tel},
		#{lxtel},
		#{age},
		#{jg},
		#{czman},
		now(),
		#{isjob},
		#{xl},
		#{zy},
		#{cardid},
		#{cate},
		#{remark},
		#{isinsuran},
		#{bylxtel},
		#{bylxr},
		#{qzqd},
		#{isimpot},
		#{location}
		)
	</insert>

    <insert id="savePerson_error" parameterType="pd">
		insert into
		tesp_person_error
		(
		uid,
		sex,
		name,
		addr,
		email,
		tel,
		lxtel,
		age,
		jg,
		czman,
		czdate,
		isjob,
		xl,
		zy,
		cardid,
		cate,
		remark,
		isinsuran,
		location,
		pcbh,
		ycstr,
		ycstrs
		) values (
		#{uid},
		#{sex},
		#{name},
		#{addr},
		#{email},
		#{tel},
		#{lxtel},
		#{age},
		#{jg},
		#{czman},
		now(),
		#{isjob},
		#{xl},
		#{zy},
		#{cardid},
		#{cate},
		#{remark},
		#{isinsuran},
		#{location},
		#{pcbh},
		#{ycstr},
		#{ycstrs}
		)
	</insert>

    <insert id="savegraduate" parameterType="pd">
		insert into
		tesp_graduatedetai
		(
		uid,
		school,
		edubg,
		jobadd,
		jobunit,
		remark,
		arrtime,
		major,
		gradate,
		extel
		)values (
		#{uid},
		#{school},
		#{edubg},
		#{jobadd},
		#{jobunit},
		#{remark},
		#{arrtime},
		#{major},
		#{gradate},
		#{extel}
		)
	</insert>

    <insert id="savegraduatedetai_error" parameterType="pd">
		insert into
		tesp_graduatedetai_error
		(
		uid,
		school,
		edubg,
		jobadd,
		jobunit,
		remark,
		arrtime,
		major,
		gradate,
		extel
		)values (
		#{uid},
		#{school},
		#{edubg},
		#{jobadd},
		#{jobunit},
		#{remark},
		#{arrtime},
		#{major},
		#{gradate},
		#{extel}
		)
	</insert>


    <update id="updateBatchByCardid" parameterType="java.util.List">
        UPDATE tesp_person a JOIN
        (
        <foreach collection="list" item="item" index="index" separator="union">
            SELECT #{item.cardId} AS cardid,
            #{item.name} AS `name`,
            #{item.sex} AS sex,
            #{item.age} AS age,
            #{item.jg} AS jg,
            #{item.tel} AS tel
        </foreach>
        ) b USING(cardid)
        SET a.name=IFNULL(b.name,a.name),a.sex = IFNULL(b.sex,a.sex),a.age =
        IFNULL(b.age,a.age),a.jg=IFNULL(b.jg,a.jg),a.tel = IFNULL(b.tel,a.tel)
    </update>
    <update id="updateBatchByTelAndName" parameterType="java.util.List">
        UPDATE tesp_person a JOIN
        (
        <foreach collection="list" item="item" index="index" separator="union">
            SELECT #{item.cardId} AS cardid,
            #{item.sex} AS sex,
            #{item.age} AS age,
            #{item.tel} AS tel,
            #{item.name} AS `name`,
            #{item.jg} AS jg
        </foreach>
        ) b USING(tel,`name`)
        SET a.sex = IFNULL(b.sex,a.sex),a.age =
        IFNULL(b.age,a.age),a.jg=IFNULL(b.jg,a.jg),a.cardid=IFNULL(b.cardid,a.cardid);
    </update>

    <insert id="saveBatch" parameterType="java.util.List">
        INSERT INTO tesp_person(uid,`name`, sex, age, jg, tel, cardid,czman,czdate,isimpot,cate)
        VALUES
        <foreach collection="list" item="item" index="index" separator=",">
            (
            (SELECT MD5(UUID())),
            #{item.name},
            #{item.sex},
            #{item.age},
            #{item.jg},
            #{item.tel},
            #{item.cardId},
            #{item.czman},
            (select now()),
            1,
            (SELECT `DICTIONARIES_ID` FROM sys_dictionaries WHERE `name_en` = "jdlkpk")
            )

        </foreach>

    </insert>


    <select id="findExportlistPage" parameterType="page" resultType="pd">
        SELECT p.id,(SELECT a.czdate FROM (
        SELECT czdate,uid FROM tesp_qtfw
        UNION ALL
        SELECT cztime AS czdate,uid FROM tesp_jobreturn
        UNION ALL
        SELECT czdate,uid FROM tesp_tj
        UNION ALL
        SELECT cztime AS czdate,uid FROM tesp_trainreco
        UNION ALL
        SELECT czdate,uid FROM tesp_ywyd
        UNION ALL
        SELECT czdate,uid FROM tesp_zczx
        UNION ALL
        SELECT cztime AS czdate,uid FROM tesp_revrecord
        UNION ALL
        SELECT czdate,uid FROM tesp_jobreg
        ) a WHERE uid = p.uid
        ORDER BY a.czdate DESC LIMIT 1) AS newServiceTime,
        (SELECT COUNT(uid) FROM (
        SELECT uid FROM tesp_qtfw
        UNION ALL
        SELECT uid FROM tesp_jobreturn
        UNION ALL
        SELECT uid FROM tesp_tj
        UNION ALL
        SELECT uid FROM tesp_trainreco
        UNION ALL
        SELECT uid FROM tesp_ywyd
        UNION ALL
        SELECT uid FROM tesp_zczx
        UNION ALL
        SELECT uid FROM tesp_revrecord
        UNION ALL
        SELECT uid FROM tesp_jobreg
        ) a WHERE uid = p.uid) AS serviceCount,
        p.jg AS jgName,
        p.name,
        p.tel,
        p.cardid,
        p.age,
        p.sex,
        p.isjob,
        (SELECT re.case FROM tesp_jobreturn re WHERE re.uid = p.uid ORDER BY re.cztime DESC LIMIT 1) AS cate,
        (SELECT GROUP_CONCAT((SELECT gwflname FROM tesp_jobtype jt WHERE jt.code = reg.jobname)) AS gwflname FROM
        tesp_jobreg reg WHERE reg.uid = p.uid) AS qzgw,
        (SELECT GROUP_CONCAT(c.name)
        FROM (SELECT a.name,a.lxr,a.addr,a.tel,b.id,b.jobname,
        CONCAT(b.agestart,'-',b.ageend) age,
        b.jobtype,
        b.xl,
        b.zyyq,
        b.remark,
        b.czman,
        b.uid,
        DATE_FORMAT(b.czdate,'%Y-%m-%d %H:%i:%s') czdate,
        b.zgrs,
        b.sex,
        b.agestart,
        b.ageend,
        b.gzdy,
        b.gwyq FROM tesp_employreg b LEFT JOIN tesp_company a ON a.uid=b.uid) c
        LEFT JOIN tesp_tj d ON c.id=d.regid
        WHERE d.uid= p.uid
        AND d.istj='1' ORDER BY c.czdate DESC LIMIT 1) AS companyName,
        (SELECT count(c.name)
        FROM (SELECT a.name,
        b.id,
        DATE_FORMAT(b.czdate,'%Y-%m-%d %H:%i:%s') czdate,
        b.uid FROM tesp_employreg b LEFT JOIN tesp_company a ON a.uid=b.uid) c
        LEFT JOIN tesp_tj d ON c.id=d.regid
        WHERE d.uid= p.uid
        AND d.istj='1' ORDER BY c.czdate DESC LIMIT 1) AS companyNum,
        (SELECT (SELECT `gwflname` FROM tesp_jobtype jt WHERE jt.code = jr.jobname) AS jobName FROM tesp_jobreturn jr
        WHERE jr.uid = p.uid ORDER BY jr.cztime DESC
        LIMIT 1) AS isjobwork,
        (SELECT jobunit FROM tesp_jobreturn jt2 WHERE jt2.uid = p.uid  order by jt2.id desc limit 1) AS jobunit,
        (SELECT GROUP_CONCAT(CONCAT((SELECT dic.name FROM `sys_dictionaries` dic WHERE dic.dictionaries_id =
        t.jobvar),',',t.trainname)) FROM tesp_trainreco t WHERE t.uid = p.uid LIMIT 1) AS trainreco,
        (SELECT IFNULL((SELECT rec.isjt FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1)
        ,
        IF((SELECT COUNT(*) FROM tesp_jobreturn jr WHERE jr.uid= p.uid ORDER BY cztime DESC LIMIT 1)=0,NULL,1)
        )) AS isjt,
        (SELECT rec.unconnet FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1) AS unconnet,
        ifnull((SELECT rec.result FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1),0) AS
        result,
        (select group_concat((select name from sys_dictionaries dic where zc.zczxname=dic.DICTIONARIES_ID)) zczxname
        from tesp_zczx zc where zc.uid=p.uid group by uid ) zczxname
        FROM tesp_person p WHERE 1=1 AND p.cate='a6d55a9451534e14aefd082634f78ad9'

        <if test="pd.startTime != null and pd.startTime != ''">
            and p.createdate &gt;= #{pd.startTime}
        </if>
        <if test="pd.endTime != null and pd.endTime != ''">
            and p.createdate &lt;= #{pd.endTime}
        </if>
        <if test="pd.result != null and pd.result != ''">
            and ifnull((SELECT rec.result FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1),0)
            = #{pd.result}
        </if>
        <if test="pd.jg != null and pd.jg != ''">
            and p.jg = (select name from sys_dictionaries dic where dic.DICTIONARIES_ID=#{pd.jg})
        </if>
        <if test="pd.tel != null and pd.tel != ''">
            and tel like CONCAT(CONCAT('%', #{pd.tel}),'%')
        </if>
        <if test="pd.isJob != null and pd.isJob != ''">
            and isjob = #{pd.isJob}
        </if>
        <if test="pd.cardId != null and pd.cardId != ''">
            and cardid = #{pd.cardId}
        </if>
        <if test="pd.id != null and pd.id != ''">
            and id = #{pd.id}
        </if>
        <if test="pd.keywords != null and pd.keywords != ''">
            AND (
            cardid LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            name LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            sex LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            tel LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            isjob LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            remark LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%')
            )
        </if>
        order by czdate desc
    </select>

    <select id="findGradeExportlistPage" parameterType="page" resultType="pd">


        SELECT * FROM(
        SELECT
        (SELECT
        a.czdate
        FROM
        (SELECT
        czdate,
        uid
        FROM
        tesp_qtfw
        UNION
        ALL
        SELECT
        cztime AS czdate,
        uid
        FROM
        tesp_jobreturn
        UNION
        ALL
        SELECT
        czdate,
        uid
        FROM
        tesp_tj
        UNION
        ALL
        SELECT
        cztime AS czdate,
        uid
        FROM
        tesp_trainreco
        UNION
        ALL
        SELECT
        czdate,
        uid
        FROM
        tesp_ywyd
        UNION
        ALL
        SELECT
        czdate,
        uid
        FROM
        tesp_zczx
        UNION
        ALL
        SELECT
        cztime AS czdate,
        uid
        FROM
        tesp_revrecord
        UNION
        ALL
        SELECT
        czdate,
        uid
        FROM
        tesp_jobreg) a
        WHERE uid = grade.uid
        ORDER BY a.czdate DESC
        LIMIT 1) AS newServiceTime,
        (SELECT
        COUNT(uid)
        FROM
        (SELECT
        uid
        FROM
        tesp_qtfw
        UNION
        ALL
        SELECT
        uid
        FROM
        tesp_jobreturn
        UNION
        ALL
        SELECT
        uid
        FROM
        tesp_tj
        UNION
        ALL
        SELECT
        uid
        FROM
        tesp_trainreco
        UNION
        ALL
        SELECT
        uid
        FROM
        tesp_ywyd
        UNION
        ALL
        SELECT
        uid
        FROM
        tesp_zczx
        UNION
        ALL
        SELECT
        uid
        FROM
        tesp_revrecord
        UNION
        ALL
        SELECT
        uid
        FROM
        tesp_jobreg) a
        WHERE uid = grade.uid) AS serviceCount,
        grade.name,
        grade.sex,
        (SELECT
        `name`
        FROM
        sys_dictionaries dic
        WHERE dic.dictionaries_id = grade.xl) AS xlName,
        grade.tel,
        CONCAT(grade.school, '-', grade.zy) AS schoolAndMajor,
        grade.isjob,
        (SELECT
        GROUP_CONCAT(
        (SELECT
        gwflname
        FROM
        tesp_jobtype jt
        WHERE jt.code = reg.jobname)
        ) AS gwflname
        FROM
        tesp_jobreg reg
        WHERE reg.uid = grade.uid) AS qzgw,
        (SELECT
        GROUP_CONCAT(DISTINCT (cresult.name))
        FROM
        (SELECT
        d.name,
        b.uid AS uid
        FROM
        tesp_tj a
        LEFT JOIN tesp_person b
        ON a.uid = b.uid
        LEFT JOIN tesp_employreg c
        ON a.regid = c.id
        LEFT JOIN tesp_company d
        ON c.uid = d.uid
        WHERE c.id IS NOT NULL
        AND a.istj = '1'
        UNION
        ALL
        SELECT
        b.name,
        d.uid AS uid
        FROM
        tesp_tj a
        LEFT JOIN tesp_company b
        ON a.uid = b.uid
        LEFT JOIN tesp_jobreg c
        ON a.regid = c.id
        LEFT JOIN tesp_person d
        ON c.uid = d.uid
        WHERE c.id IS NOT NULL
        AND a.istj = '1') cresult
        WHERE cresult.uid = grade.uid) AS companyName,
        (SELECT count(c.name)
        FROM (SELECT a.name,
        b.id,
        DATE_FORMAT(b.czdate,'%Y-%m-%d %H:%i:%s') czdate,
        b.uid FROM tesp_employreg b LEFT JOIN tesp_company a ON a.uid=b.uid) c
        LEFT JOIN tesp_tj d ON c.id=d.regid
        WHERE d.uid= grade.uid
        AND d.istj='1' ORDER BY c.czdate DESC LIMIT 1) AS companyNum,
        (SELECT GROUP_CONCAT(DISTINCT(dic.name)) FROM sys_dictionaries dic LEFT JOIN tesp_zczx zczx ON zczx.zczxname =
        dic.dictionaries_id WHERE dic.parent_id = '67476843c25e48b29f8610635e780a4f'
        AND zczx.uid = grade.uid) AS trainReco,
        (SELECT GROUP_CONCAT(DISTINCT(dic.name)) FROM sys_dictionaries dic LEFT JOIN tesp_zczx zczx ON zczx.zczxname =
        dic.dictionaries_id WHERE dic.parent_id = 'faac2c854cb34c4892a85584fc48976f'
        AND zczx.uid = grade.uid) AS jobHelp,
        IFNULL((SELECT jr.jobunit FROM tesp_jobreturn jr WHERE jr.uid = grade.uid ORDER BY czdate DESC LIMIT
        1),grade.jobunit) AS jobUnit,
        (IFNULL(DATE_FORMAT((SELECT jr.jobtime FROM tesp_jobreturn jr WHERE jr.uid = grade.uid ORDER BY czdate DESC
        LIMIT 1),'%Y-%m-%d'),'未知')) AS jobTime,
        (SELECT re.case FROM tesp_jobreturn re WHERE re.uid = grade.uid ORDER BY re.id DESC LIMIT 1) AS remark,
        grade.result,
        (select group_concat((select name from sys_dictionaries dic where zc.zczxname=dic.DICTIONARIES_ID)) zczxname
        from tesp_zczx zc where zc.uid=grade.uid group by uid ) zczxname,
        grade.createdate,
        grade.cardid

        FROM
        (SELECT
        p.id,
        p.uid,
        p.`sex`,
        p.`name`,
        p.`addr`,
        p.`email`,
        p.`tel`,
        p.`lxtel`,
        p.`age`,
        p.`jg`,
        p.`czman`,
        p.`czdate`,
        p.`isjob`,
        p.`xl`,
        p.`zy`,
        p.`cardid`,
        p.`isimpot`,
        p.`createdate`,
        p.`cate`,
        d.`school`,
        d.`edubg`,
        d.`jobadd`,
        d.`jobunit`,
        d.remark,
        d.`arrtime`,
        d.`major`,
        d.`gradate`,
        d.`extel`,
        (CASE WHEN rev.result=0 THEN '未回访'
        WHEN rev.result is null THEN '未回访'
        WHEN rev.result=1 THEN '已回访'
        ELSE '未回访' END ) AS resultname,
        (CASE WHEN rev.result=0 THEN '0'
        WHEN rev.result is null THEN '0'
        WHEN rev.result=1 THEN '1'
        ELSE '0' END ) AS result
        FROM
        tesp_person p
        LEFT JOIN tesp_graduatedetai d
        ON d.uid = p.uid
        left join
        (SELECT
        *
        FROM
        tesp_revrecord
        WHERE id in
        (SELECT
        MAX(id)
        FROM
        tesp_revrecord
        GROUP BY uid)) rev on rev.uid=p.uid
        WHERE p.cate = '7c2896ad53df4440b81c251231b196fd'
        ) grade ) result WHERE 1 = 1
        <if test="pd.starttime != null and pd.starttime != ''">
            and result.createdate &gt;= #{pd.starttime}
        </if>
        <if test="pd.endtime != null and pd.endtime != ''">
            and result.createdate &lt;= #{pd.endtime}
        </if>
        <if test="pd.result != null and pd.result != ''">
            and result = #{pd.result}
        </if>
        <if test="pd.jobtype != null and pd.jobtype != ''">
            and isjob = #{pd.jobtype}
        </if>
        <if test="pd.result != null and pd.result != ''">
            and result = #{pd.result}
        </if>
        <if test="pd.arrtime != null and pd.arrtime != ''">
            and jobTime &gt;= #{pd.arrtime}
        </if>
        <if test="pd.keywords != null and pd.keywords != ''">
            AND (
            newServiceTime LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            serviceCount LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            name LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            sex LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            cardid LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            xlName LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            tel LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            schoolAndMajor LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            isjob LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            qzgw LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            companyName LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            trainReco LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            jobHelp LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            jobUnit LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            jobTime LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            remark LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%')
            )
        </if>
    </select>

    <update id="gradeEditBatch" parameterType="pd">
		update tesp_jobreturn
		set
		`uid`=#{uid},
		`jobtime`='未知',
		`jobunit`=#{jobunit},
		`case`=#{case},
		`czman`=#{czman},
		`cztime`=now()
		WHERE uid=#{uid}
	</update>

    <insert id="gradeSaveBatch" parameterType="java.util.List">
        insert into `tesp_jobreturn` (
        `uid`,
        `jobtime`,
        `jobunit`,
        `czman`,
        `cztime`
        )
        values
        <foreach collection="list" item="item" index="index" separator=",">

            (
            #{item.uid},
            '未知',
            #{item.jobunit},
            #{item.czman},
            now()
            )

        </foreach>

    </insert>

    <select id="findotherPersonexport" resultType="pd" parameterType="pd">
        SELECT p.id,(SELECT a.czdate FROM (
        SELECT czdate,uid FROM tesp_qtfw
        UNION ALL
        SELECT cztime AS czdate,uid FROM tesp_jobreturn
        UNION ALL
        SELECT czdate,uid FROM tesp_tj
        UNION ALL
        SELECT cztime AS czdate,uid FROM tesp_trainreco
        UNION ALL
        SELECT czdate,uid FROM tesp_ywyd
        UNION ALL
        SELECT czdate,uid FROM tesp_zczx
        UNION ALL
        SELECT cztime AS czdate,uid FROM tesp_revrecord
        UNION ALL
        SELECT czdate,uid FROM tesp_jobreg
        ) a WHERE uid = p.uid
        ORDER BY a.czdate DESC LIMIT 1) AS newServiceTime,
        (SELECT COUNT(uid) FROM (
        SELECT uid FROM tesp_qtfw
        UNION ALL
        SELECT uid FROM tesp_jobreturn
        UNION ALL
        SELECT uid FROM tesp_tj
        UNION ALL
        SELECT uid FROM tesp_trainreco
        UNION ALL
        SELECT uid FROM tesp_ywyd
        UNION ALL
        SELECT uid FROM tesp_zczx
        UNION ALL
        SELECT uid FROM tesp_revrecord
        UNION ALL
        SELECT uid FROM tesp_jobreg
        ) a WHERE uid = p.uid) AS serviceCount,
        p.jg AS jgName,
        p.name,
        p.lxtel,
        p.cardid,
        p.age,
        p.sex,
        p.isjob,
        (SELECT re.case FROM tesp_jobreturn re WHERE re.uid = p.uid ORDER BY re.cztime DESC LIMIT 1) AS cate,
        (SELECT GROUP_CONCAT((SELECT gwflname FROM tesp_jobtype jt WHERE jt.code = reg.jobname)) AS gwflname FROM
        tesp_jobreg reg WHERE reg.uid = p.uid) AS qzgw,
        (SELECT GROUP_CONCAT(c.name)
        FROM (SELECT a.name,a.lxr,a.addr,a.tel,b.id,b.jobname,
        CONCAT(b.agestart,'-',b.ageend) age,
        b.jobtype,
        b.xl,
        b.zyyq,
        b.remark,
        b.czman,
        b.uid,
        DATE_FORMAT(b.czdate,'%Y-%m-%d %H:%i:%s') czdate,
        b.zgrs,
        b.sex,
        b.agestart,
        b.ageend,
        b.gzdy,
        b.gwyq FROM tesp_employreg b LEFT JOIN tesp_company a ON a.uid=b.uid) c
        LEFT JOIN tesp_tj d ON c.id=d.regid
        WHERE d.uid= p.uid
        AND d.istj='1' ORDER BY c.czdate DESC LIMIT 1) AS companyName,
        (SELECT count(c.name)
        FROM (SELECT a.name,
        b.id,
        DATE_FORMAT(b.czdate,'%Y-%m-%d %H:%i:%s') czdate,
        b.uid FROM tesp_employreg b LEFT JOIN tesp_company a ON a.uid=b.uid) c
        LEFT JOIN tesp_tj d ON c.id=d.regid
        WHERE d.uid= p.uid
        AND d.istj='1' ORDER BY c.czdate DESC LIMIT 1) AS companyNum,
        (SELECT (SELECT `gwflname` FROM tesp_jobtype jt WHERE jt.code = jr.jobname) AS jobName FROM tesp_jobreturn jr
        WHERE jr.uid = p.uid ORDER BY jr.cztime DESC
        LIMIT 1) AS isjobwork,
        (SELECT jobunit FROM tesp_jobreturn jt2 WHERE jt2.uid = p.uid order by jt2.id desc limit 1) AS jobunit,
        (SELECT GROUP_CONCAT(CONCAT((SELECT dic.name FROM `sys_dictionaries` dic WHERE dic.dictionaries_id =
        t.jobvar),',',t.trainname)) FROM tesp_trainreco t WHERE t.uid = p.uid LIMIT 1) AS trainreco,
        (SELECT IFNULL((SELECT rec.isjt FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1)
        ,
        IF((SELECT COUNT(*) FROM tesp_jobreturn jr WHERE jr.uid= p.uid ORDER BY cztime DESC LIMIT 1)=0,NULL,1)
        )) AS isjt,
        (SELECT rec.unconnet FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1) AS unconnet,
        ifnull((SELECT rec.result FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1),0) AS
        result,
        (select group_concat((select name from sys_dictionaries dic where zc.zczxname=dic.DICTIONARIES_ID)) zczxname
        from tesp_zczx zc where zc.uid=p.uid group by uid ) zczxname
        FROM tesp_person p WHERE 1=1 AND (p.cate='95df4fa459264d77b508c963b4ebbe21' or p.cate='' or p.cate is null)

        <if test="startTime != null and startTime != '' and startTime != 'undefined'">
            and p.createdate &gt;= #{startTime}
        </if>
        <if test="endTime != null and endTime != '' and endTime != 'undefined'">
            and p.createdate &lt;= #{endTime}
        </if>
        <if test="isjob != null and isjob != ''">
            and isjob = #{isjob}
        </if>
        <if test="result != null and result != ''">
            and ifnull((SELECT rec.result FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1),0)
            = #{result}
        </if>
        <if test="keywords != null and keywords != ''  and keywords != 'undefined'">
            AND (
            cardid LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            name LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            sex LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            tel LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            isjob LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            remark LIKE CONCAT(CONCAT('%', #{keywords}),'%')
            )
        </if>
        order by czdate desc

    </select>


    <select id="findLoseJoblistPage" parameterType="page" resultType="pd">
        select * from
        (
        SELECT
        a.id,
        a.name,
        a.isinsuran,
        a.bylxtel,
        a.bylxr,
        a.qzqd,
        a.location,
        <if test="pd.tables!= null and pd.tables!= ''">
            a.ycstr,
            a.ycstrs,
            a.pcbh,
        </if>
        a.isjob,
        (CASE a.sex WHEN '1' THEN '1'
        WHEN '2' THEN '2'
        ELSE '暂无' END) sex,
        a.cardid,
        a.xl,
        (select dic.name from sys_dictionaries dic where dic.DICTIONARIES_ID=a.xl) as xlname,
        a.jg AS address,
        a.lxtel AS tel,
        a.zy,
        DATE_FORMAT(a.czdate,'%Y-%m-%d %H:%i:%s') czdate,
        a.czman,
        a.uid,
        a.cate,
        IFNULL((SELECT (CASE WHEN re.result=0 THEN '0' WHEN re.result IS NULL THEN '0' WHEN re.result=1 THEN '1' ELSE '0' END )
        FROM tesp_revrecord re WHERE re.uid IS NOT NULL  AND a.uid=re.uid ORDER BY re.cztime DESC LIMIT 0,1),0) AS result,
        IFNULL((SELECT (CASE WHEN re.result=0 THEN '未回访' WHEN re.result IS NULL THEN '未回访' WHEN re.result=1 THEN '已回访' ELSE '未回访' END )
        FROM tesp_revrecord re WHERE re.uid IS NOT NULL  AND a.uid=re.uid ORDER BY re.cztime DESC LIMIT 0,1),'未回访') AS resultname,
        b.certificate_id,
        DATE_FORMAT(b.certificate_date,'%Y-%m-%d %H:%i:%s') certificate_date,
        b.certificate_unit
        FROM
        <if test="pd.tables!= null and pd.tables!= ''">
            ${pd.tables} a
        </if>
        <if test="pd.tables== null or pd.tables== ''">
            tesp_person a
        </if>
        LEFT JOIN
        <if test="pd.tables2!= null and pd.tables2!= ''">
            ${pd.tables2} b
        </if>
        <if test="pd.tables2== null or pd.tables2== ''">
            tesp_LoseJobDetail b
        </if>
        ON a.uid=b.uid
        WHERE a.cate='617b2f6e122a43c9a86b5b25129aecc5'
        ) a
        WHERE 1=1
        <if test="pd.result!=null and pd.result!=''">
            and a.result=#{pd.result}
        </if>
        <if test="pd.isjob!=null and pd.isjob!=''">
            and a.isjob=#{pd.isjob}
        </if>
        <if test="pd.certificate_unit!=null and pd.certificate_unit!=''">
            and a.certificate_unit=#{pd.certificate_unit}
        </if>
        <if test="pd.certificate_id!=null and pd.certificate_id!=''">
            and a.certificate_id=#{pd.certificate_id}
        </if>
        <if test="pd.starttime!=null and pd.starttime!='' and pd.endtime!=null and pd.endtime!=''">
            AND certificate_date BETWEEN #{pd.starttime} and #{pd.endtime}
        </if>
        <if test="pd.name!=null and pd.name!=''">
            and a.name=#{pd.name}
        </if>
        <if test="pd.pcbh!= null and pd.pcbh!= ''">
            and a.pcbh =#{pd.pcbh}
        </if>
        <if test="pd.keywords != null and pd.keywords != ''">
            AND (
            name LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            isinsuran LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            location LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            (CASE WHEN result=0 THEN '未回访'
            WHEN result is null THEN '未回访'
            WHEN result=1 THEN '已回访'
            ELSE '未回访' END ) LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            certificate_id LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            address LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            certificate_date LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            certificate_unit LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            tel LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%') OR
            cardid LIKE CONCAT(CONCAT('%', #{pd.keywords}),'%')
            )
        </if>
    </select>

    <insert id="insertLoseJob" parameterType="pd">
		insert into `tesp_LoseJobDetail` (
		`uid`,
		`certificate_id`,
		`certificate_date`,
		`certificate_unit`,
		`czman`,
		`czdate`
		)
		values
		(
		#{uid},
		#{certificate_id},
		#{certificate_date},
		#{certificate_unit},
		#{czman},
		#{czdate}
		)
	</insert>

    <insert id="insertLoseJob_error" parameterType="pd">
		insert into `tesp_LoseJobDetail_error` (
		`uid`,
		`certificate_id`,
		`certificate_date`,
		`certificate_unit`,
		`czman`,
		`czdate`

		)
		values
		(
		#{uid},
		#{certificate_id},
		#{certificate_date},
		#{certificate_unit},
		#{czman},
		#{czdate}
		)
	</insert>

    <update id="updateLoseJob" parameterType="pd">
		update tesp_LoseJobDetail
		set
		uid=#{uid},
		certificate_id=#{certificate_id},
		certificate_date=#{certificate_date},
		certificate_unit=#{certificate_unit},
		czman=#{czman},
		czdate=#{czdate}
		WHERE id=#{id}
	</update>

    <delete id="deteleLoseJob" parameterType="pd">
		delete from tesp_losejobdetail where uid=#{uid}
	</delete>

    <delete id="detelePerson" parameterType="pd">
		delete from tesp_person where uid=#{uid}
	</delete>

    <insert id="insertjobregerror" parameterType="pd">
		INSERT INTO tesp_jobreg_error(
			jobname,
			jobtype,
			qwxz,
			jobaddr,
			remark,
			czman,
			uid,
			czdate,
			isvalid,
			isimpot,
			specificjobname,
			experience
		)VALUES (
			#{jobname},
			#{jobtype},
			#{qwxz},
			#{jobaddr},
			#{remark},
			#{czman},
			#{uid},
			#{czdate},
			#{isvalid},
			#{isimpot},
			#{specificjobname},
			#{experience}
		)
	</insert>

    <select id="findlostjobexport" resultType="pd" parameterType="pd">
        SELECT p.id,(SELECT a.czdate FROM (
        SELECT czdate,uid FROM tesp_qtfw
        UNION ALL
        SELECT cztime AS czdate,uid FROM tesp_jobreturn
        UNION ALL
        SELECT czdate,uid FROM tesp_tj
        UNION ALL
        SELECT cztime AS czdate,uid FROM tesp_trainreco
        UNION ALL
        SELECT czdate,uid FROM tesp_ywyd
        UNION ALL
        SELECT czdate,uid FROM tesp_zczx
        UNION ALL
        SELECT cztime AS czdate,uid FROM tesp_revrecord
        UNION ALL
        SELECT czdate,uid FROM tesp_jobreg
        ) a WHERE uid = p.uid
        ORDER BY a.czdate DESC LIMIT 1) AS newServiceTime,
        (SELECT COUNT(uid) FROM (
        SELECT uid FROM tesp_qtfw
        UNION ALL
        SELECT uid FROM tesp_jobreturn
        UNION ALL
        SELECT uid FROM tesp_tj
        UNION ALL
        SELECT uid FROM tesp_trainreco
        UNION ALL
        SELECT uid FROM tesp_ywyd
        UNION ALL
        SELECT uid FROM tesp_zczx
        UNION ALL
        SELECT uid FROM tesp_revrecord
        UNION ALL
        SELECT uid FROM tesp_jobreg
        ) a WHERE uid = p.uid) AS serviceCount,
        p.jg AS jgName,
        p.name,
        p.lxtel,
        p.cardid,
        p.age,
        p.sex,
        p.isjob,
        lo.certificate_id,
        lo.certificate_date,
        lo.certificate_unit,
        (SELECT re.case FROM tesp_jobreturn re WHERE re.uid = p.uid ORDER BY re.cztime DESC LIMIT 1) AS cate,
        (SELECT GROUP_CONCAT((SELECT gwflname FROM tesp_jobtype jt WHERE jt.code = reg.jobname)) AS gwflname FROM
        tesp_jobreg reg WHERE reg.uid = p.uid) AS qzgw,
        (SELECT GROUP_CONCAT(c.name)
        FROM (SELECT a.name,a.lxr,a.addr,a.tel,b.id,b.jobname,
        CONCAT(b.agestart,'-',b.ageend) age,
        b.jobtype,
        b.xl,
        b.zyyq,
        b.remark,
        b.czman,
        b.uid,
        DATE_FORMAT(b.czdate,'%Y-%m-%d %H:%i:%s') czdate,
        b.zgrs,
        b.sex,
        b.agestart,
        b.ageend,
        b.gzdy,
        b.gwyq FROM tesp_employreg b LEFT JOIN tesp_company a ON a.uid=b.uid) c
        LEFT JOIN tesp_tj d ON c.id=d.regid
        WHERE d.uid= p.uid
        AND d.istj='1' ORDER BY c.czdate DESC LIMIT 1) AS companyName,
        (SELECT count(c.name)
        FROM (SELECT a.name,
        b.id,
        DATE_FORMAT(b.czdate,'%Y-%m-%d %H:%i:%s') czdate,
        b.uid FROM tesp_employreg b LEFT JOIN tesp_company a ON a.uid=b.uid) c
        LEFT JOIN tesp_tj d ON c.id=d.regid
        WHERE d.uid= p.uid
        AND d.istj='1' ORDER BY c.czdate DESC LIMIT 1) AS companyNum,
        (SELECT (SELECT `gwflname` FROM tesp_jobtype jt WHERE jt.code = jr.jobname) AS jobName FROM tesp_jobreturn jr
        WHERE jr.uid = p.uid ORDER BY jr.cztime DESC
        LIMIT 1) AS isjobwork,
        (SELECT jobunit FROM tesp_jobreturn jt2 WHERE jt2.uid = p.uid  order by jt2.id desc limit 1) AS jobunit,
        (SELECT GROUP_CONCAT(CONCAT((SELECT dic.name FROM `sys_dictionaries` dic WHERE dic.dictionaries_id =
        t.jobvar),',',t.trainname)) FROM tesp_trainreco t WHERE t.uid = p.uid LIMIT 1) AS trainreco,
        (SELECT IFNULL((SELECT rec.isjt FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1)
        ,
        IF((SELECT COUNT(*) FROM tesp_jobreturn jr WHERE jr.uid= p.uid ORDER BY cztime DESC LIMIT 1)=0,NULL,1)
        )) AS isjt,
        (SELECT rec.unconnet FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1) AS unconnet,
        ifnull((SELECT rec.result FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1),0) AS
        result,
        (select group_concat((select name from sys_dictionaries dic where zc.zczxname=dic.DICTIONARIES_ID)) zczxname
        from tesp_zczx zc where zc.uid=p.uid group by uid ) zczxname
        FROM tesp_person p left join tesp_losejobdetail lo on p.uid=lo.uid WHERE 1=1 AND
        p.cate='617b2f6e122a43c9a86b5b25129aecc5'

        <if test="result != null and result != ''">
            and ifnull((SELECT rec.result FROM tesp_revrecord rec WHERE rec.uid = p.uid ORDER BY cztime DESC LIMIT 1),0)
            = #{result}
        </if>
        <if test="keywords != null and keywords != ''">
            AND (
            cardid LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            name LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            sex LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            tel LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            isjob LIKE CONCAT(CONCAT('%', #{keywords}),'%') OR
            remark LIKE CONCAT(CONCAT('%', #{keywords}),'%')
            )
        </if>
        <if test="isjob!=null and isjob!=''">
            and isjob=#{isjob}
        </if>
        <if test="certificate_unit!=null and certificate_unit!=''">
            and certificate_unit=#{certificate_unit}
        </if>
        <if test="certificate_id!=null and certificate_id!=''">
            and certificate_id=#{certificate_id}
        </if>
        <if test="starttime!=null and starttime!='' and endtime!=null and endtime!=''">
            AND DATE_FORMAT(lo.certificate_date,'%Y-%m-%d %H:%i:%s') BETWEEN #{starttime} and #{endtime}
        </if>
        <if test="name!=null and name!=''">
            and name=#{name}
        </if>


    </select>

    <insert id="insertcompany_error" parameterType="pd">
	INSERT INTO tesp_company_error(
		uid,
		qytype,
		name,
		addr,
		email,
		lxr,
		tel,
		lxtel,
		bylxr,
		bylxtel,
		czman,
		czdate,
		isinsuran,
		intro,
		qzqd,
		isimpot,
		pcbh,
		ycstr,
		ycstrs
	)VALUES (
		#{uid},
		#{qytype},
		#{name},
		#{addr},
		#{email},
		#{lxr},
		#{tel},
		#{lxtel},
		#{bylxr},
		#{bylxtel},
		#{czman},
		#{czdate},
		#{isinsuran},
		#{intro},
		#{qzqd},
		#{isimpot},
		#{pcbh},
		#{ycstr},
		#{ycstrs}
	)
	</insert>

    <insert id="insertemployreg_error" parameterType="pd">
	INSERT INTO tesp_employreg_error(
		jobname,
		jobtype,
		xl,
		zyyq,
		remark,
		czman,
		uid,
		czdate,
		zgrs,
		sex,
		agestart,
		ageend,
		gzdy,
		gwyq,
		isimpot,
		gzaddr,
		specificjobname,
		experience,
		pcbh,
		ycstr,
		ycstrs
	)VALUES (
		#{jobname},
		#{jobtype},
		#{xl},
		#{zyyq},
		#{remark},
		#{czman},
		#{uid},
		#{czdate},
		#{zgrs},
		#{sex},
		#{agestart},
		#{ageend},
		#{gzdy},
		#{gwyq},
		#{isimpot},
		#{gzaddr},
		#{specificjobname},
		#{experience},
		#{pcbh},
		#{ycstr},
		#{ycstrs}
	)
	</insert>
</mapper>